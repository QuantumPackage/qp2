name: QP Configuration

on:
  push:
    branches:
    - master
    - ci
  pull_request:
    branches:
    - master
  schedule:
  - cron: "23 22 * * 6"


jobs:

  configuration:
    runs-on: ubuntu-20.04
    name: Dependencies

    steps:
       - uses: actions/checkout@v3
       - name: Install dependencies
         run: |
           sudo apt install gfortran gcc liblapack-dev libblas-dev wget python3 make m4 pkg-config
       - name: zlib
         run: |
              ./configure -i zlib
       - name: ninja
         run: |
              ./configure -i ninja
       - name: zeromq
         run: |
              ./configure -i zeromq
       - name: f77zmq
         run: |
              ./configure -i f77zmq
       - name: gmp
         run: |
              ./configure -i gmp
       - name: ocaml
         run: |
              ./configure -i ocaml
       - name: docopt
         run: |
              ./configure -i docopt
       - name: resultsFile
         run: |
              ./configure -i resultsFile
       - name: bats
         run: |
              ./configure -i bats
       - name: Cache
         uses: actions/cache@v3
         with:
           key: qp2-config
           path: |
             external/opampack/
             include/
             lib/
             lib64/
             libexec/

